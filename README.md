# ПОИИС
Репозиторий дисциплины Представление и обработка информации в интеллектуальных системах 
(Representation and processing of information in intelligent systems) для групп потока 32170х.
С условиями лабораторных работ можно ознакомиться в папке соответствующего семестра.

# Условие лабораторной работы (№66):
Создать файл sh и bat, который выполняет следующее: 
На вход пакетному файлу приходит относительный путь к папке (как параметр пакетного файла). 
Если такой папки нет, то писать “Данной папки нет” и завершить выполнение программы. 
Папка должна содержать другие папки (несколько уровней вложенности) и файлы. 
Отсортировать имена папок, содержащихся в указанной в порядке возрастания количества находящихся в них файлов, результат вывести в файл result.txt

# РЕШЕНИЕ

[Алгоритм bat](#title1)

[Пример выполнения bat-скрипта](#title2)

[Алгоритм shell](#title3)

[Пример выполнения shell-скрипта](#title4)

# <a id="title1">Алгоритм bat</a>

![image](https://github.com/lilulw/aaa/assets/146581542/0bab6dfa-c4b2-4a96-bf01-5a9cee580efa)

1. ` @echo off ` Отключаем вывод команд в консоль, чтобы скрипт работал в "тихом" режиме.
2. ` chcp 65001 ` Устанавливаем кодировку консоли на UTF-8, чтобы корректно отображались символы национальных языков (кириллица).
3. ` setlocal enabledelayedexpansion ` Включаем отложенное разрешение переменных (позволяет использовать изменяемые переменные внутри циклов).

4. Блок кода 1

![image](https://github.com/lilulw/aaa/assets/146581542/04c603ae-26ed-41e2-bd54-820db3df2aa9)

- Проверяем, был ли передан аргумент командной строки (путь к папке). Если нет, то выводится сообщение "Пожалуйста, укажите путь к папке в качестве аргумента" и скрипт завершается с кодом ошибки 1.
5. Блок кода 2

![image](https://github.com/lilulw/aaa/assets/146581542/fcb16e8c-7c90-4057-9bfe-e90ca278415d)

- Проверяем, существует ли указанная папка. Если нет, то выводится сообщение "Данной папки нет" и скрипт завершается с кодом ошибки 1.

6. ` set "temp_file=temp.txt"  ` Устанавливаем имя временного файла, который будет использоваться для сохранения промежуточных результатов.
7. ` del "%temp_file%" ` Если временный файл уже существует, то удаляем его.
8. Блок кода 3

![image](https://github.com/lilulw/aaa/assets/146581542/ef8bf9ef-54fc-486b-a14e-47a800e1ed7b)

 - Цикл ` for /d %%a in ("%~1%\*") do ` перебирает все подкаталоги в указанной папке. Каждый подкаталог сохраняется в переменной %%a.
 - Внутри цикла устанавливается начальное значение переменной file_count равным 0.
 - Цикл ` for %%b in ("%%a\*") do ` перебирает все файлы в текущем подкаталоге (%%a). Каждый файл сохраняется в переменной %%b.
 - Внутри вложенного цикла переменная file_count увеличивается на 1 с помощью команды ` set /a "file_count+=1" `

 - ` echo !file_count!, %%~nxa >> "%temp_file%" `После завершения вложенного цикла, количество файлов и имя текущего подкаталога (%%a) записываются в файл %temp_file%. Здесь !file_count! - значение переменной file_count, а %%~nxa - имя текущего подкаталога без пути.

9. ` sort "%temp_file%" > "temp1.txt" ` сортируем содержимое файла %temp_file% и сохраняем результат в файле temp1.txt.
10. ` (for /f "tokens=1,* delims=," %%c in (temp1.txt) do echo %%d) > "result.txt" ` считываем содержимое файла temp1.txt, разделяем каждую строку на две части по разделителю "," и выводим только вторую часть каждой строки (имя подкаталога) в файл result.txt.
11. ` echo Список подкаталогов отсортирован и сохранен в файле result.txt. ` вывод сообщения о выполнении работы.
12. ` del "%temp_file%" `
13. ` del "temp1.txt" ` удаляем временные файлы %temp_file% и temp1.txt.

# <a id="title2">Пример выполнения bat-скрипта</a>
![image](https://github.com/lilulw/aaa/assets/146581542/4b00161f-e78a-4b5d-97f5-d38dd3012ae6)
![image](https://github.com/lilulw/aaa/assets/146581542/e83727ba-98d7-4df4-b751-5c6aebcc5308)


# <a id="title3">Алгоритм shell</a>

![image](https://github.com/lilulw/aaa/assets/146581542/9a2342d8-ef15-4340-841b-7fc31e60a357)

1. Блок кода 1

![image](https://github.com/lilulw/aaa/assets/146581542/65754bca-87c5-4a62-a630-a010f1ecd865)

- Проверяем, был ли передан аргумент - путь к папке. Если аргумент отсутствует, выводит сообщение об ошибке и завершает выполнение скрипта с кодом 1.

2. Блок кода 2

![image](https://github.com/lilulw/aaa/assets/146581542/11976d7c-1bd8-47d2-82b4-fb670a25fa88)

- Проверяем, существует ли указанная папка. Если папка не существует, выводит сообщение об ошибке и завершает выполнение скрипта с кодом 1.

3. Блок кода 3

![image](https://github.com/lilulw/aaa/assets/146581542/3e898db4-7b37-46e3-bc11-61eed9f41269)

 - Используя команду `find`, скрипт находит все подкаталоги в указанной папке и передает их в цикл `while read -r dir`.
 - Внутри цикла скрипт проверяет, что текущий каталог не является корневым каталогом (чтобы исключить саму указанную папку).
 - С помощью команды `find` скрипт находит все файлы в текущем каталоге (не включая подкаталоги) и считает их количество с помощью команды `wc -l`.
 - С помощью команды `basename` скрипт получает только имя текущего каталога без пути.
 - С помощью команды `echo` счётчик файлов и имя каталога записываются в файл temp.txt в формате "количество_файлов,имя_каталога".

4. `cut -d',' -f2 temp1.txt > result.txt` скрипт вырезает второе поле (имя каталога) из файла `temp1.txt` и записывает результат в файл `result.txt`.
5. `rm temp.txt 
rm temp1.txt` Удаляем временные файлы `temp.txt` и `temp1.txt`.
6. `echo Список подкаталогов отсортирован и сохранен в файле result.txt.` вывод сообщения о выполнении работы.

# <a id="title4">Пример выполнения shell-скрипта </a>

## ПЕРЕД ЗАПУСКОМ СКРИПТА НУЖНО ВЫПОЛНИТЬ СЛЕДУЮЩИЕ КОМАНДЫ: (установка последних обновлений + программы dos2unix, т.к. файл был сохранён в программе, использующей стиль окончания строк DOS), а также выдача прав на исполнение скрипта

- `chmod +x LR1_Linux.sh`
 
- `sudo apt install dos2unix`

- `sudo apt-get update`

- `sudo apt-get install dos2unix`

- `dos2unix LR1_Linux.sh`
  
![КОД](https://github.com/lilulw/aaa/assets/146581542/72f7344f-9132-475f-8115-1f467f37bc9b)
