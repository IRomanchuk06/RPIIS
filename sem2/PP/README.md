# расчетная работа

## задание

Поиск в подграфов в неориенторованном графе изоморфных графу-образцу

## Ключевые понятия

`Граф` - математическая абстракция реальной системы любой природы, объекты которой обладают парными связями. 

Два графа называются `изоморфными`, если у них одинаковое число вершин (обозначим его n) и вершины каждого из них можно занумеровать так числами от 1 до n, что в первом графе две вершины соединены ребром тогда и только тогда, когда вершины с такими же номерами во втором графе соединены.  

![изоморфные графы](imgs/isomorphic_graphs.png)

`Подграф` - это часть графа, в которой мы берем некоторые его вершины и ребра. Другими словами, граф `H` является подграфом графа `G`, если вершины и ребра `H` являются подмножеством вершин и ребер `G`.  


`Неориентированные` графы - это графы у которых порядок двух концов ребра не существенен.

![неориентированный граф на OSTIS](imgs/undirected_graph_OSTIS.png)
![неориентированный граф в kbe](imgs/undirected_graph_kbe.png)

### традиционная запись графов
![граф](imgs/graph_view1_kbe.png)
![граф](imgs/graph_view1_OSTIS.png)

### запись графов, которая будет использоваться
![граф](imgs/graph_view2_kbe.png)
![граф](imgs/graph_view2_OSTIS.png)


## тесты

### тест 1
**Вход**: на вход подается два графа: исходный граф и граф образец.  

![исходный граф](imgs/graph1_inp1.png)
![граф образец](imgs/graph1_inp2.png)

**Выход**: на выходе будет множество из трех графов.  

![результат](imgs/graph1_out.png)

### тест 2
**Вход**: на вход подается два графа: исходный граф и граф образец.  

![исходный граф](imgs/graph2_inp1.png)
![граф образец](imgs/graph2_inp2.png)

**Выход**: на выходе будет пустое множество, т.е. изоморфных подграфов не существует.  

![результат](imgs/graph2_out.png)

### тест 3
**Вход**: на вход подается два графа: исходный граф и граф образец.  

![исходный граф](imgs/graph3_inp1.png)
![граф образец](imgs/graph3_inp2.png)

**Выход**: на выходе будет множество из двух графов.  

![результат](imgs/graph3_out.png)

### тест 4
**Вход**: на вход подается два графа: исходный граф и граф образец.  

![исходный граф](imgs/graph4_inp1.png)
![граф образец](imgs/graph4_inp2.png)

**Выход**: на выходе будет пустое множество, т.к. граф образец больше чем исходный граф.  

![результат](imgs/graph4_out.png)

### тест 5
**Вход**: на вход подается два графа: исходный граф и граф образец.  

![исходный граф](imgs/graph5_inp1.png)
![граф образец](imgs/graph5_inp2.png)

**Выход**: на выходе будет множество из двух графов.  

![результат](imgs/graph5_out.png)


## описание алгоритма

- **Исходный граф** будет обозначаться `G`
- **Граф образец** будет обозначаться `H`

1. **Инициализация**:
    - Определить количество вершин `|V_G|` и рёбер `|E_G|` в исходном графе `G`.
    - Определить количество вершин `|V_H|` и рёбер `|E_H|` в графе-образце `H`.

2. **Рекурсивное построение подграфов**:
    - Для каждой вершины `v` в исходном графе `G`:
        - Инициализировать текущий подграф с вершиной `v`.
        - Запустить рекурсивную функцию для расширения подграфа.

3. **Рекурсивная функция для расширения подграфа**:
    - **Входные параметры**: текущий подграф `P`, множество доступных для добавления вершин `C`, отображение вершин `mapping`.
    - **Базовый случай**: Если размер текущего подграфа `|V_P|` равен `|V_H|`, то:
        - Проверить, изоморфен ли `P` графу-образцу `H`.
        - Если да, сохранить отображение `mapping`.
    - **Рекурсивный случай**:
        - Для каждой вершины `u` из множества доступных вершин `C`:
            - Добавить вершину `u` в текущий подграф `P`.
            - Обновить отображение `mapping`.
            - Обновить множество доступных для добавления вершин `C'`, добавив смежные с `u` вершины, которые ещё не в подграфе.
            - Рекурсивно вызвать функцию для нового подграфа `P` и множества доступных вершин `C'`.
            - Удалить вершину `u` из текущего подграфа `P` (откат изменений для следующей итерации).

4. **Сохранение изоморфных подграфов**:
    - Если найдено изоморфное отображение, сохранить его в список результатов. Убедиться в уникальности результатов, избегая дублирования.

## алгоритм

Граф `_G` - это исходный граф в котором будет производиться поиск изоморфных подграфов, `_H` - граф образец, `_P` - текущий подграф, с которым будут производиться все операции `_C` - все вершины графа `_G`, которые еще не были добавлены в `_P`.  

![алгоритм шаг 0](imgs/algo_step0.png)

Берем одну из вершин графа `_C` и добавляем ее в `_P`, после увеличиваем счетчик отвечающий за количество вершины графа `_P`. Повторяем это действие до тех пор, пока количество вершин графа `_P` не станет равным количеству вершин графа образца.  

![алгоритм шаг 1](imgs/algo_step1.png)
![алгоритм шаг 2](imgs/algo_step2.png)
![алгоритм шаг 3](imgs/algo_step3.png)

После проверяем граф `_P` на изоморфность с графом образцом. Если они изоморфны, то сохраняем текущий граф в результат, иначе ничего не делаем. Затем сбрасываем граф `_P` до исходного состояния и повторяем предыдущие шаги до тех пор, пока не будут найдены все изоморфные подграфы.  

![алгоритм шаг 4](imgs/algo_step4.png)
![алгоритм шаг 5](imgs/algo_step5.png)
![алгоритм шаг 6](imgs/algo_step6.png)
![алгоритм шаг 7](imgs/algo_step7.png)
![алгоритм шаг 8](imgs/algo_step8.png)
![алгоритм шаг 9](imgs/algo_step9.png)
![алгоритм шаг 10](imgs/algo_step10.png)
![алгоритм шаг 11](imgs/algo_step11.png)
![алгоритм шаг 12](imgs/algo_step12.png)
![алгоритм шаг 13](imgs/algo_step13.png)
![алгоритм шаг 14](imgs/algo_step14.png)
В конце выполнения алгоритма в переменной `_результат` будут записаны все подграфы изоморфные графу образцу.

## заключение

Были освоены понятия, связанные с графом, был разработан алгоритм нахождения изоморфных подграфов. Получен опыт формализации алгоритмов на scg-коде.
