# BSUIR cmd-bash
В рамках ЛР 1 необходимо создать файл с разрешением *bat.* и *sh.* в соответствии с заданным вариантом.
Цель данной лаборотоной работы - ознакомится с командными строками операционных систем *Windows* и *Linux*.

## Условие ЛР1 (40 вариант)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/468163c8-8977-4200-96a6-4020e389d96b)


# Описание алгоритма, пример запуска и выполнения программы (.bat)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/7e05c99a-c5fd-4e13-9cba-c18a8963ff70)


#### Используемые переменные:
- folder - переменная, указывающая путь к папке, в котором находиться необходимый нам батник
- resultFile - переменная, которая указыввает файл, в котором будут сохранены результаты вычислений моего батника
- totalSize - переменная, которая указывает суммарный размер файлов, находящихся в указанной директории
- fileCount - переменная, которая указвает число просмотренных файлов в папке, которую пользователь выбрал в дирректории

## Разбор кода:
echo "baobab"
chcp 65001 > nul
setlocaltimeout /t -1


- echo "baobab": Это просто команда echo, которая выводит на экран строку "baobab"(может быть удалена без влияния на основную функциональность скрипта)
- chcp 65001 > nul: Эта команда устанавливает кодировку вывода на консоли в UTF-8 (код 65001). > nul перенаправляет вывод на ноль и подавляет вывод результатов команды.
- setlocaltimeout /t -1: Эта команда задает время ожидания командной строки на бесконечный интервал (бесконечное ожидание). 

set "folder=%~2"
set "resultFile=results.txt"


- set "folder=%~2": Эта команда присваивает значение переменной folder второго аргумента командной строки (%~2).
- set "resultFile=results.txt": Эта команда устанавливает значение переменной resultFile в "results.txt", то есть имя файла, в который будет записан результат.

if not exist "%folder%" (
    echo Данной папки нет.
    exit /b
)


- if not exist "%folder%": Это выражение проверяет существование папки, указанной в переменной folder. Если папка не существует, код внутри блока if выполняется.
- echo Данной папки нет.: Выполняется команда echo, которая выводит на экран сообщение "Данной папки нет.".
- exit /b: Это команда завершает выполнение скрипта и возвращает код выхода.

echo Каталог, суммарный размер файлов, число просмотренных файлов > %resultFile%
call :processFolder "%folder%" %resultFile%
echo Результаты вычислений сохранены в файле %resultFile%
exit /b


- echo Каталог, суммарный размер файлов, число просмотренных файлов > %resultFile%: Эта команда выводит заголовок в файл resultFile (в данном случае "results.txt"). > используется для перенаправления вывода команды в файл, а >> используется для добавления в файл без удаления существующего содержимого.
- call :processFolder "%folder%" %resultFile%: Эта команда вызывает подпрограмму :processFolder и передает ей значения переменных folder и resultFile в качестве параметров.
- echo Результаты вычислений сохранены в файле %resultFile%: Эта команда выводит сообщение о сохранении результатов в файле на экран.

:processFolder
set "folder=%~1"
set "resultFile=%~2"
set "totalSize=0"
set "fileCount=0"
for /r "%folder%" %%A in (*) do (
    set /a "totalSize+=%%~zA"
    set /a "fileCount+=1"
)
echo %folder%, %totalSize%, %fileCount% >> %resultFile%
for /d %%B in ("%folder%\*") do (
    call :processFolder "%%B" %resultFile%
)
exit /b


- :processFolder: Это метка, обозначающая начало подпрограммы (функции) processFolder. Здесь начинается код, который будет выполнен при вызове этой подпрограммы.
- set "folder=%~1": Эта команда присваивает значение переменной folder первого аргумента подпрограммы (%~1).
- set "resultFile=%~2": Эта команда присваивает значение переменной resultFile второго аргумента подпрограммы.
- set "totalSize=0" и set "fileCount=0": Эти команды придают переменным totalSize и fileCount нулевое значение.
- for /r "%folder%" %%A in (*) do (...): Это цикл for, который перебирает все файлы и папки внутри директории, указанной в переменной folder. Для каждого файла выполняется код внутри блока do.
- set /a "totalSize+=%%~zA" и set /a "fileCount+=1": Эти команды увеличивают значения переменных totalSize и fileCount на размер текущего файла и на 1 соответственно.
- echo %folder%, %totalSize%, %fileCount% >> %resultFile%: Эта команда выводит результаты (путь к каталогу, суммарный размер файлов, число просмотренных файлов) в файл resultFile.
- for /d %%B in ("%folder%\*") do (...): Это цикл for, который перебирае

т все подпапки внутри текущей директории. Для каждой подпапки выполняется код внутри блока do.
- call :processFolder "%%B" %resultFile%: Эта команда вызывает подпрограмму processFolder рекурсивно для каждой подпапки.
      
## Пример и алгоритм работы:
    Запуск командной строки 
    
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/f7195625-abdf-4273-9bc0-d5b597c55588)


    Открытие .bat файла:
    Переход к папке - _cd_путь к папке_
    Запуск .bat файла - gg.bat "baobab" "D:\BSUIR\ПиОИвИС\пиво лаба 1" 
    
    ![image](https://github.com/iis-32170x/RPIIS/assets/143909949/8cca9b1e-7904-4fce-b8f9-a17fa1735371)


    Нажатие любой клавиши (timeout /t -1)
    Выполнение программы


![image](https://github.com/iis-32170x/RPIIS/assets/143909949/7c0dd4d6-7543-4a16-8b04-0639fb835db5)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/93435250-c480-41cf-8e2f-cdc7512da8cb)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/af57e37c-e158-47f8-b995-26c8a578c9df)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/d2ea8e6d-e03a-4674-9d9a-a29343d9b505)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/dbd3a86f-f772-4c40-a701-f1d74dae6a77)







    Результат работы ввиде текстового файла с указанными нужными нам данными.
    
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/561c32ae-3657-47fa-8092-eda4ef8338ff)

![image](https://github.com/iis-32170x/RPIIS/assets/143909949/1be307a4-4fc9-4617-8d08-a6ea3ea9eb83)


Работа .bat файла окончена.

# Описание алгоритма, пример запуска и выполнения программы (.sh)

![image](https://github.com/iis-32170x/RPIIS/assets/143909949/a51093eb-d312-4ed5-bea8-3154c533a531)


#### Используемые переменные
- target_path - переменная, которая предназначена для сохранения второго аргумента командной строки
- directory - локальная переменная, которая устанавливается внутри функции calculate_directory_size, обозначает путь к папке
- totalSize - переменная, которая указывает суммарный размер файлов, находящихся в указанной директории
- fileCount - переменная, которая указвает число просмотренных файлов в папке, которую пользователь выбрал в дирректории


## Разбор кода

#!/bin/bash

- Эта строка указывает, что скрипт должен быть выполняемым в среде оболочки bash.

# Проверяем количество аргументов
if [ "$#" -lt 2 ]; then
  echo "Необходимо указать строку и путь к папке!"
  exit 1
fi

- Здесь мы проверяем количество аргументов командной строки с помощью выражения [ "$#" -lt 2 ]. Если аргументов меньше двух, выводится сообщение об ошибке и скрипт завершается с кодом выхода 1.

target_path="$2"

- Мы сохраняем второй аргумент командной строки (путь к папке) в переменной target_path.

# Проверяем существование папки
if [ ! -d "$target_path" ]; then
  echo "Данной папки '$target_path' нет"
  exit 1
fi

- Здесь мы проверяем существование папки, указанной в переменной target_path, с помощью условного выражения [ ! -d "$target_path" ]. Если папки не существует, выводится сообщение об ошибке, и скрипт завершается с кодом выхода 1.

# Функция для обхода файлов и папок
calculate_directory_size() {
  local directory="$1"
  local total_size=0
  local total_files=0

  # Цикл для обхода файлов и папок в заданной директории
  for item in "$directory"/*; do
    if [ -d "$item" ]; then
      # Если элемент является папкой, вызываем эту же функцию рекурсивно
      calculate_directory_size "$item"
    elif [ -f "$item" ]; then
      # Если элемент является файлом, увеличиваем суммарный размер и число файлов
      file_size=$(stat -c "%s" "$item")
      total_size=$((total_size + file_size))
      total_files=$((total_files + 1))
    fi
  done

  # Выводим результаты в файл
  echo "$directory ($directory), суммарный размер всех файлов: $total_size, число просмотренных файлов: $total_files" >> results.txt
}

- Здесь определена функция calculate_directory_size, которая принимает один аргумент - путь к директории.

- Внутри функции устанавливаются локальные переменные directory, total_size и total_files.

- Затем выполняется цикл for, который перебирает все файлы и папки в заданной директории. Для каждого элемента происходит проверка, является ли он папкой или файлом.

- Если элемент является папкой, функция calculate_directory_size вызывается рекурсивно для этой папки.

- Если элемент является файлом, получаем его размер с помощью команды stat -c "%s" "$item" и увеличиваем значения переменных total_size и total_files.

- После обхода всех файлов и папок результаты выводятся в файл results.txt с помощью команды echo.

# Вызываем функцию для основной директории
calculate_directory_size "$target_path"

- Здесь функция calculate_directory_size вызывается для основной директории, которая была передана в скрипт вторым аргументом командной строки.

## Пример и алгоритм работы:
    Запуск командной строки через Git-Bash

![image](https://github.com/iis-32170x/RPIIS/assets/143909949/f03b23f2-4492-4362-b865-0431811cf542)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/0c783c0b-feed-4630-b69c-f02ef6310f2a)

    Запуск программы 

![image](https://github.com/iis-32170x/RPIIS/assets/143909949/5c6ef788-8d69-4864-841a-edd36571fc39)


    Результат работы - текстовый файл с нужными нам данными
   
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/063c8aab-f8db-43dc-8935-b495ffce07d7)
![image](https://github.com/iis-32170x/RPIIS/assets/143909949/66ea293b-7de8-4a11-b46f-a11011c763cf)



Работа .sh файла окончена.
